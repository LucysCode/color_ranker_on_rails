<h1 style="text-align:center">Welcome to Color Ranker where you can rank ugly colors!</h1>
<h2 style="text-align:center">Is this color ugly?</h2>
<p style="text-align:center">Select up to <%= @max_colors %> ugly colors and <%= @max_colors %> great colors!</p>



<div style="text-align:center; margin-top: 20px;">
    <form method="get" action="/">
      <input type="hidden" name="new_color" value="true">
      <button type="submit">Not sure, give me a new color</button>
    </form>
</div>

<% unless @show_pikachu %>
  <div class="color-box" style="background-color: <%= @hex_color %>;"></div>
<% end %>

<% if @show_pikachu %>
  <p style="text-align: center;">
    <img src="<%= @image_url %>" alt="Surprised Pikachu" style="max-width: 300px; height: auto;" />
    <br>
    <small>
      Image from
      <a href="https://knowyourmeme.com/memes/surprised-pikachu" target="_blank" rel="noopener noreferrer">
        Know Your Meme
      </a>
    </small>
  </p>
<% end %>


<p style="text-align:center">Color Code: <%= @hex_color %></p>


<div style="text-align:center;">
    <button onclick="submitVote('ugly')">Ew, it&rsquo;s ugly</button>
    <button onclick="submitVote('nice')">
    Great color</button>
</div>



<% if @message %>
  <p style="color: red; text-align:center;"><%= @message %></p>
<% end %>

<% if flash[:notice] %>
  <p style="color: red; text-align:center;"><%= flash[:notice] %></p>
<% end %>

<div style="text-align:center;">
  <form method="post" action="/reset">
    <%= hidden_field_tag :authenticity_token, form_authenticity_token %>
    <button type="submit">Reset</button>
  </form>
</div>

<% if @ugly_colors.present? %>
  <h3 style="text-align:center; margin-top: 40px;">Top Ugly Colors</h3>
  <div style="display:flex; justify-content:center; flex-wrap: wrap; gap: 10px;">
    <% @ugly_colors.each do |color| %>
      <div style="width: 60px; height: 60px; background-color: <%= color %>; border: 1px solid #000;"></div>
    <% end %>
  </div>
<% end %>

<% if @nice_colors.present? %>
  <h3 style="text-align:center; margin-top: 40px;">Top Nice Colors</h3>
  <div style="display:flex; justify-content:center; flex-wrap: wrap; gap: 10px;">
    <% @nice_colors.each do |color| %>
      <div style="width: 60px; height: 60px; background-color: <%= color %>; border: 1px solid #000;"></div>
    <% end %>
  </div>
<% end %>

<script>
  function submitVote(vote) {
    fetch('/vote', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'X-CSRF-Token': '<%= form_authenticity_token %>'
      },
      body: JSON.stringify({ vote: vote })
    }).then(response => {
      if (response.ok) {
        window.location.href = "/?new_color=true";
      } else {
        alert("Failed to submit vote.");
      }
    });
  }
</script>
